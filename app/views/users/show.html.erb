<div class="container">
  <div class="row">

    <div id="content-left" class="content-area col-md-6 col-xs-12">
      <div class ="content-box">
        <h2 class="content-box-head user-info">利用者情報</h2>
        <div class="content-box-body user-info">
          <div>
            <%= attachment_image_tag @user, :image, :fill, 200, 200, fallback:"/images/no_image.png" %>
          </div>
          <h3><%= @user.name %></h3>
          <!-- 利用者本人か、管理者のみメールアドレス表示 -->
          <% if signed_in_user_or_admin?(@user) %>
            <p><%= @user.email %></p>
          <% end %>
          <p>ライブラリ保存数：<%= @libraries %></p>
        </div>
        <div class="content-box-foot">
          <!-- 利用者本人か、管理者のみ編集ボタン表示 -->
          <% if signed_in_user_or_admin?(@user) %>
            <div id="sub-content-show" class="btn">利用者情報の編集</div>
          <% end %>
        </div>
      </div>
    </div>

    <div id="content-right" class="content-area col-md-6 col-xs-12">
      <div class ="content-box">
        <div id="main-content">
          <% if @user == current_user %>
            <h2 class ="content-box-head user-history">最近閲覧したストーリー</h2>
            <div class="user-history">
              <% @visiteds.each do |visited| %>
                <div class="story-list clearfix">
                  <p><%= link_to visited.story.title, story_path(visited.story) %> / <%= link_to visited.story.user.name, user_path(visited.story.user) %></p>
                  <p>
                    <%= visited.story.created_at.strftime("%Y - %-m - %-d / %-H : %-M") %>/
                    ライブラリ登録数：<%= visited.story.libraries.count %>
                  </p>
                </div>
              <% end %>
            <% else %>
              <h2 class ="content-box-head user-history">作成したストーリー</h2>
              <div class="user-history">
                <%= render '/stories/story_list', stories: @user.stories %>
              </div>
            <% end %>
          </div>
        </div>
      <!-- 編集ボタンクリック時に表示 -->
        <div id="sub-content">
          <h2 class ="content-box-head user-edit">利用者情報の編集</h2>
          <div class="user-edit">
            <%= form_for(@user) do |f| %>
              <h3><%= f.text_field :name, placeholder:"変更後の名前" %></h3>
              <p><%= f.text_field :email, placeholder:"変更後のメールアドレス" %></p>
              <%= f.attachment_field :image %>
              <p><%= f.submit "更新", class:"btn" %></p>
              <div id="sub-content-hide" class="btn">更新のキャンセル</div>
              <div class="content-box-foot">
                <% if @user.deleted_user == false %>
                  <%= link_to "利用者情報の削除", unsubscribe_user_path(@user), method: :patch, class:"btn btn-alert" %>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>